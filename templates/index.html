{% extends "base.html" %}

{% block title %}Dashboard | Financeiro{% endblock %}

{% block content %}
<!-- Auth Layer -->
<div id="auth-screen" class="overlay">
    <div class="lock-container">
        <div class="lock-brand">
            <i class="fas fa-user-lock"></i>
            <h1 id="auth-title">Bem-vindo</h1>
            <p id="auth-subtitle">Entre na sua conta segura</p>
        </div>

        <div class="auth-forms">
            <div class="form-group">
                <input type="text" id="auth-username" placeholder="Usu√°rio">
            </div>
            <div class="form-group">
                <input type="password" id="auth-password" placeholder="Senha">
            </div>

            <button class="btn-primary" style="width:100%; margin-bottom: 1rem;" id="auth-btn">Entrar</button>
            <button class="text-btn" id="auth-toggle">N√£o tem conta? Crie agora</button>
        </div>

        <p class="crypto-note" style="margin-top: 2rem;"><i class="fas fa-shield-alt"></i> Sua sess√£o √© protegida por
            JWT.</p>
    </div>
</div>

<!-- Main App Layout -->
<div id="app" class="hidden">
    <aside id="sidebar">
        <div class="sidebar-header">
            <div class="logo">
                <i class="fas fa-shield-halved"></i>
                <span>Financeiro</span>
            </div>
            <button id="menu-toggle" class="menu-btn mobile-only">
                <i class="fas fa-bars"></i>
            </button>
        </div>

        {% include "partials/navbar.html" %}

        <div class="mobile-only sidebar-footer-mobile" style="padding: 1rem 2rem;">
            <button id="logout-btn-mobile" class="text-btn"
                style="width: 100%; color: var(--danger); text-align: center;">
                <i class="fas fa-sign-out-alt"></i> Sair
            </button>
        </div>

        <div class="sidebar-footer">
            <div class="quote-card">
                <p id="motivational-quote">"O controle financeiro √© o primeiro passo para a liberdade."</p>
            </div>
            <button id="logout-btn" class="text-btn" style="margin-top: 1rem; width: 100%; color: var(--danger);">
                <i class="fas fa-sign-out-alt"></i> Sair
            </button>
        </div>
    </aside>

    <main id="main-content">
        <header>
            <div class="welcome">
                <h2>Ol√°, <span class="username">Visitante</span> üëã</h2>
                <p id="current-date"></p>
            </div>
            <div class="actions">
                <button id="btn-new-record" class="btn-primary"><i class="fas fa-plus"></i> Novo
                    Registro</button>
            </div>
        </header>

        <!-- Dashboard Section -->
        <section id="dashboard" class="content-section">
            <div class="stats-grid">
                <div class="stat-card balance">
                    <div class="stat-icon"><i class="fas fa-wallet"></i></div>
                    <div class="stat-info">
                        <h3>Saldo Total</h3>
                        <p class="value" id="total-balance">R$ 0,00</p>
                    </div>
                </div>
                <div class="stat-card income">
                    <div class="stat-icon"><i class="fas fa-arrow-up"></i></div>
                    <div class="stat-info">
                        <h3>Ganhos</h3>
                        <p class="value" id="total-income">R$ 0,00</p>
                    </div>
                </div>
                <div class="stat-card expenses">
                    <div class="stat-icon"><i class="fas fa-arrow-down"></i></div>
                    <div class="stat-info">
                        <h3>Despesas</h3>
                        <p class="value" id="total-expenses">R$ 0,00</p>
                    </div>
                </div>
            </div>

            <div class="dashboard-secondary">
                <div class="recent-activity card">
                    <div class="card-header">
                        <h3>Atividade Recente</h3>
                        <button class="text-btn nav-to-transactions">Ver tudo</button>
                    </div>
                    <div class="transaction-list" id="recent-transactions">
                        <p class="empty-state">Nenhuma transa√ß√£o carregada.</p>
                    </div>
                </div>
                <div class="caixinhas-preview card">
                    <div class="card-header">
                        <h3>Minhas Caixinhas</h3>
                        <button class="text-btn nav-to-caixinhas">Ver todas</button>
                    </div>
                    <div class="caixinhas-grid-mini" id="caixinhas-mini-list">
                        <p class="empty-state">Sem reservas.</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- Transactions Section -->
        <section id="transactions" class="content-section hidden">
            <div class="section-header" style="margin-bottom: 2rem;">
                <h2>Hist√≥rico de Transa√ß√µes</h2>
            </div>
            <div class="card">
                <div class="transaction-list" id="full-transaction-list"></div>
            </div>
        </section>

        <!-- Caixinhas Section -->
        <section id="caixinhas" class="content-section hidden">
            <div class="section-header"
                style="display:flex; justify-content: space-between; align-items: center; margin-bottom: 2rem;">
                <h2>Minhas Caixinhas</h2>
                <button id="btn-create-caixinha" class="btn-primary"><i class="fas fa-plus"></i> Criar
                    Caixinha</button>
            </div>
            <div class="caixinhas-grid" id="full-caixinhas-list"></div>
        </section>

        {% include "partials/settings.html" %}

        <!-- Tips Section -->
        <section id="tips" class="content-section hidden">
            <div class="tips-container">
                <h2 style="margin-bottom: 2rem;">Dicas Financeiras üí°</h2>
                <div class="tips-grid" id="tips-grid-content"></div>
            </div>
        </section>
    </main>
</div>

<!-- SECURE TEMPLATES -->
<template id="tpl-transaction">
    <div class="transaction-item">
        <div class="t-main">
            <div class="t-icon"><i class="fas"></i></div>
            <div class="t-info">
                <p class="t-desc-val"></p>
                <span class="t-meta">
                    <i class="fas fa-calendar-day"></i> <span class="t-date-val"></span>
                    <span class="badge t-cat-badge"></span>
                    <span class="badge badge-installment t-inst-badge"><i class="fas fa-layer-group"></i> <span
                            class="t-inst-val"></span></span>
                </span>
            </div>
        </div>
        <div class="t-amount"></div>
        <div class="t-actions">
            <button class="delete-transaction-btn" title="Remover"><i class="fas fa-trash-alt"></i></button>
        </div>
    </div>
</template>

<template id="tpl-caixinha">
    <div class="caixinha-card">
        <div class="card-header">
            <h3 class="c-name-val"></h3>
            <i class="fas fa-piggy-bank"></i>
        </div>
        <p><span class="c-curr-val"></span> / <span class="c-target-val"></span></p>
        <div class="progress-container">
            <div class="progress-bar">
                <div class="progress-fill"></div>
            </div>
            <span><span class="c-percent-val"></span>% alcan√ßado</span>
        </div>
        <button class="btn-primary invest-btn" style="width:100%; margin-top:1rem">Investir</button>
    </div>
</template>

<template id="tpl-caixinha-mini">
    <div style="margin-bottom:1rem">
        <small class="c-name-mini"></small>
        <div class="progress-bar" style="height:6px">
            <div class="progress-fill"></div>
        </div>
    </div>
</template>
{% endblock %}